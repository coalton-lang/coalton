(in-package #:coalton-impl/doc)

;; TODO: remove this
(defun write-predicate-to-markdown (ctx pred)
  ;; TODO: Only link if the thing is part of the package being documented
  (labels ((base-type (type)
             (typecase type
               (coalton-impl/typechecker::tapp
                (base-type (coalton-impl/typechecker::tapp-from type)))
               (t
                type))))
    (let ((class (ty-predicate-class pred))
          (types (ty-predicate-types pred)))
      (format nil "<code>:[;=> ]<a href=\"#A\">A</a>窿集泔溴劲祜镳烘矧痱邃洪泗烘矧沆狍航豉痱邃殂狒瀛沆狍痱邃烘矧豉疱航豉痱邃殂狒瀛豉疱痱邃恒镬戾泗ㄦ矧磲铋⒓栩彐杰￣淋⒕窿窿集峋沆狍沆狍豉疱螬泗沆狍沆狍祜镳烘矧豉疱洪豉疱烘矧忉箦豉疱洪磲疸狎＇忉箦豉疱豉疱螬恒镬戾泗ㄦ矧磲铋⒓栩彐杰￣淋⒕良峋忉箦豉疱豉疱┅┅┅换换湾翳镤骘滓稍怒南谜团卧猎上换换韵南娘翳痱彐轼轭骘骈戾扉铍ㄤ彐礤翳镤黩轸瀛滹沲礤铘狒轱è忉汶孱ㄥ耢Ш磲螂滹黝┅篝蝈犴镡赍泗滹沲礤铘狒轱瞽骈戾孱趄┅鏖翳箪雉ㄦ殪孱犴鲠祯瀛孱趄殄豉疱孱趄殄沆狍蟓孱趄殄扉铍痱彐轼镡赍泗换族镱禊麽铘麸黩轸滹沲礤铘狒轱麒孱翳弪轶滹沲礤铘狒轱麸黩轸瀹麒孱矧鲠祯瀛孱趄殄豉疱孱趄殄沆狍蟓孱趄殄螬ㄦ矧磲篝蝈犴＃崎戾埝凛俩ア骈戾钺礤ㄣ镱汜翦钺翦篝蜷铉扉铍痱彐轼骈戾钺礤┅换序轭豉疱轭骘蝽狒轱麒孱豉疱孱趄殄ㄦ矧磲篝蝈犴＃赠疱簋アㄤ镬轶ㄥ铘蝙豉疱孱趄殄螬黩轸瀛滹沲礤铘狒轱忉汶孱篝蝈犴孱趄ㄦ矧磲篝蝈犴オア┅换序轭沆狍轭骘蝽狒轱麒孱沆狍蟓孱趄殄ㄦ矧磲篝蝈犴＃渺狍箦簋アㄤ镬轶ㄥ铘蝙沆狍蟓孱趄殄螬黩轸瀛滹沲礤铘狒轱忉汶孱篝蝈犴孱趄ㄦ矧磲篝蝈犴オア┅换序轭鲠祯轭骘蝽狒轱麒孱鲠祯瀛孱趄殄ㄦ矧磲篝蝈犴＃契钽糸镱簋アㄤ镬轶ㄥ铘蝙鲠祯瀛孱趄殄螬黩轸瀛滹沲礤铘狒轱忉汶孱篝蝈犴孱趄ㄦ矧磲篝蝈犴オア┅┅┅ㄤ彐礤翳镤黩轸瀛滹沲礤铘狒轱è忉汶孱ㄥ耢Ш磲螂滹黝┅篝蝈犴镡赍泗滹沲礤铘狒轱瞽豉疱孱趄┅戾è钺礤ㄤ镢蹴孱翎糸镱孱趄钺礤镡赍泗┅豉疱ㄤ镢蹴孱翎糸镱豉疱孱趄豉疱镡赍泗┅ㄣ麸蝮ㄤ镢蹴孱翎糸镱豉疱孱趄泔铙趄蹉麸蝮镡赍泗┅ㄩ铙翎钽弩ㄤ镢蹴孱翎糸镱豉疱孱趄轭篝犷沐镡赍泗┅鏖翳痧蜷铘鲠蜷徕戾泔铘屮ī戾è豉疱鲠蝮祜镳烘矧衡屐秣ㄣ镝祠镱轫痨豉疱汨邈脲蚝弘轭洵狎轸ㄣ镝祠镱轫痨豉疱汨邈脲蚝弘轭洵镦豉疱┅恒镬戾泗ㄣ镝祠镱轫痨豉疱汨邈脲蚝喉犭瀛鲠蜷徕戾┅┅ㄦ矧磲篝蝈犴＃＃笺镤寰窿窿集泔溴俭躔炯篚饩墼傩泡集篚饩集篚鹁坚钺礤杰淋⒕集峋ア钺礤豉疱鲠蝮钺礤祜镳烘矧ㄣ麸颦钺礤孱趄洪泗矧轰戾è狎珞ㄣ镝祠镱轫痨豉疱汨邈脲蚝烘躅泗轱瞽豉疱狎珲礤铘ㄣ镝祠镱轫痨豉疱汨邈脲蚝厚踽扉骈邃豉豉疱ㄣ镝祠镱轫痨豉疱汨邈脲蚝洪铙翎铘獒翦豉疱鲠蝮ㄣ镝祠镱轫痨豉疱汨邈脲蚝呼筱桢礤豉疱ㄣ镱篝蝓泗矧孱趄筱桢礤孱趄┅┅┅ㄩ狎珞ㄦ矧磲篝蝈犴笺镤寰窿窿┘泔溴峻ア泗矧钺礤狎珞ㄦ矧磲篝蝈犴笺镤寰良泔溴峻ア泗矧钺礤┅┅戾è滹泱ㄤ镢蹴孱翎糸镱钺礤豉疱┅麒孱滹泱ㄦ矧磲篝蝈犴窿ア滹泱┅ㄦ矧磲篝蝈犴アㄦ矧磲篝蝈犴⒚镱篝蝓泗矧蠛ア祜镳烘矧ㄣ麸颦钺礤孱趄洪泗矧轰ㄦ矧磲篝蝈犴笺镤寰汉良泔溴峻ア泗矧钺礤ㄣ镝祠镱轫痨豉疱汨邈脲蚝洪铙翎铘獒翦豉疱鲠蝮ㄣ镝祠镱轫痨豉疱汨邈脲蚝呼筱桢礤豉疱ㄣ镱篝蝓泗矧孱趄筱桢礤孱趄┅┅ㄦ矧磲篝蝈犴ア麒孱轭篝犷沐ㄦ矧磲篝蝈犴⒓溴翎殪缶アㄦ矧磲篝蝈犴⒓篚眄狎旧铙翎钽弩集篚眄狎峻ア祜镳烘矧轭篝犷沐洪轭篝犷沐轰鏖翳痧蜷铘鲠蜷徕戾泔铘屮īㄦ矧磲篝蝈犴窿ア黩轸瀛痱邃殂狒瀛麸磲螂滹黝豉沆狍蟓轭篝犷沐泔铙趄衢铘轭篝犷沐豉沆狍蟓轭篝犷沐痱邃殂狒轭篝犷沐┅┅ㄦ矧磲篝蝈犴ゼ溴翎殪缶ア┅┅┅ㄤ彐礤翳镤黩轸瀛滹沲礤铘狒轱è忉汶孱ㄥ耢Ш磲螂滹黝┅篝蝈犴镡赍泗滹沲礤铘狒轱瞽沆狍蟓孱趄┅鏖翳箪雉钺礤泔铘屮痱邃殂狒礤翳镤轭篝犷沐滹沲礤铘狒轱祜汜糸镱镡赍泗ㄦ矧磲篝蝈犴＃＃笺镤寰良泔溴俭躔炯篚饩勖塘佑菁篚饩集篚鹁坚钺礤杰淋⒕集峋ア钺礤钺礤鏖翳痧蜷铘鲠蜷徕戾泔铘屮īㄦ矧磲篝蝈犴窿ア黩轸瀛痱邃殂狒瀛麸磲螂滹黝泔铘屮痱邃殂狒濠麒孱滹沲礤铘狒轱ㄦ矧磲篝蝈犴窿ア滹沲礤铘狒轱瞟ㄦ矧磲篝蝈犴⑼弭栾潴湖ア祜镳烘矧钺礤豉疱洪礤翳镤轰ㄦ矧磲篝蝈犴笺镤寰汉良泔溴峻ア钺礤豉疱┅麒孱轭篝犷沐ㄦ矧磲篝蝈犴ゼ溴翎殪缶アㄦ矧磲篝蝈犴⒓篚眄狎旧铙翎钽弩集篚眄狎峻ア祜镳烘矧轭篝犷沐洪轭篝犷沐轰鏖翳痧蜷铘鲠蜷徕戾泔铘屮īㄦ矧磲篝蝈犴窿ア黩轸瀛痱邃殂狒瀛麸磲螂滹黝豉沆狍蟓轭篝犷沐泔铙趄衢铘轭篝犷沐豉沆狍蟓轭篝犷沐痱邃殂狒轭篝犷沐┅┅ㄦ矧磲篝蝈犴ゼ溴翎殪缶ア┅┅ㄤ彐礤翳镤黩轸瀛滹沲礤铘狒轱è忉汶孱ㄥ耢Ш磲螂滹黝┅篝蝈犴镡赍泗滹沲礤铘狒轱瞽鲠祯瀛孱趄┅鏖翳箪雉钺礤豉疱滹沲礤铘狒轱祜汜糸镱镡赍泗ㄦ矧磲篝蝈犴＃＃笺镤寰良泔溴俭躔炯篚饩燮瘴迷上屋集篚饩集篚鹁坚钺礤杰淋⒕集峋ア钺礤钺礤ㄦ矧磲篝蝈犴⒓泔溴峻良泔溴峻ア豉疱麒孱滹沲礤铘狒轱ㄦ矧磲篝蝈犴窿ア滹沲礤铘狒轱瞟┅